{"version":3,"sources":["business/home/AppStartCard.tsx","business/home/Home.tsx","business/scheduler/service/SchedulerService.ts"],"names":["AppStatCard","stat","t","useTranslation","className","style","backgroundColor","color","Icon","name","marginRight","scheduler","maxHeight","paddingLeft","paddingRight","paddingTop","margin","padding","to","ROUTE_LIVE_SCHEDULES","data-tooltip","total_live","ROUTE_ALL_SCHEDULES","total","Home","useState","stats","setStats","useEffect","a","console","log","getAppStats","map","st","makeSearchArgs","p","res","scheduleId","sort","sortOrder","epochFrom","epochTo","get","getAppStatsUrl","listAllSchedulers","getSchedulersUrl","makeScheduleInfoModel","schedules","o","id","schedule","timestamp","epoch","targetTopic","targetId","value","makeScheduleModel","schedulerName","topic","searchLiveSchedules","getLiveSchedulesUrl","result","found","searchSchedules","getSchedulesUrl","getScheduleDetail","getScheduleDetailUrl","length","sch","Error","getLiveScheduleDetail","getLiveScheduleDetailUrl"],"mappings":"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","file":"static/js/11.d1fc737e.chunk.js","sourcesContent":["import { AppStat } from \"business/scheduler/service/SchedulerService\";\nimport { useTranslation } from \"react-i18next\";\nimport { Link } from \"react-router-dom\";\nimport Icon from \"_common/component/element/icon/Icon\";\nimport { ROUTE_ALL_SCHEDULES, ROUTE_LIVE_SCHEDULES } from \"_core/router/routes\";\n\ntype AppStatCardProps = {\n  stat: AppStat;\n};\n\nconst AppStatCard: React.FC<AppStatCardProps> = ({ stat }) => {\n  const { t } = useTranslation();\n  return (\n    <div className=\"column is-4-tablet is-4-desktop\">\n      <div className=\"card\">\n        <div className=\"card-header\" style={{ backgroundColor: \"orange\" }}>\n          <h3 className=\"card-header-title is-inline\" style={{ color: \"white\" }}>\n              <Icon name={\"stopwatch\"} style={{marginRight:20}}  className={\"has-tooltip-right\"} />{\" \"}\n               <span>{stat.scheduler}</span>\n          </h3>\n        </div>\n        <div\n          className=\"card-content\"\n          style={{\n            maxHeight: 450,\n            backgroundColor: \"#f5f5f5\",\n            paddingLeft: 0,\n            paddingRight: 0,\n            paddingTop: \"1rem\",\n          }}\n        >\n          <h3\n            className=\"subtitle is-6\"\n            style={{\n              margin: 0,\n              padding: \"1rem\",\n            }}\n          >\n            <Link to={ROUTE_LIVE_SCHEDULES + \"?schedulerName=\" + stat.scheduler}>\n              <Icon name={\"calendar\"} style={{marginRight:20}}  className={\"has-tooltip-right\"} data-tooltip={t(\"SchedulesLive\")} />{\" \"}\n              {stat.total_live} {t(\"SchedulesLive\")}\n            </Link>\n          </h3>\n          <h3\n            className=\"subtitle is-6\"\n            style={{\n              margin: 0,\n              padding: \"1rem\",\n            }}\n          >\n            <Link to={ROUTE_ALL_SCHEDULES + \"?schedulerName=\" + stat.scheduler}>\n              <Icon name={\"calendar-alt\"}  style={{marginRight:20}} className={\"has-tooltip-right\"} data-tooltip={t(\"Schedules\")} />{\" \"}\n              {stat.total} {t(\"Schedules\")}\n            </Link>\n          </h3>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AppStatCard;\n","import { AppStat, getAppStats } from \"business/scheduler/service/SchedulerService\";\nimport { useEffect, useState } from \"react\";\nimport AppStatCard from \"./AppStartCard\";\n\nconst Home = () => {\n  const [stats, setStats] = useState<AppStat[]>([]);\n\n  useEffect( () => {\n    (async ()=>{\n      console.log(\"Home\");\n      const stats = await getAppStats();\n\n      setStats(stats);\n    })();\n  }, [])\n\n  return <div className=\"columns\" style={{margin:\"3rem\"}}>\n      {stats.map (st => {\n        return <AppStatCard key={st.scheduler} stat={st} />\n      })}\n  </div>;\n};\n\nexport default Home;\n","import { get } from \"_common/service/ApiUtil\";\nimport {\n  getAppStatsUrl,\n  getLiveScheduleDetailUrl,\n  getLiveSchedulesUrl,\n  getScheduleDetailUrl,\n  getSchedulersUrl,\n  getSchedulesUrl,\n} from \"_core/service/config\";\nimport { Schedule, ScheduleInfo, Scheduler } from \"../type\";\n\nexport type SortType = \"id\" | \"epoch\" | \"timestamp\";\nexport type SortOrder = \"asc\" | \"desc\";\nexport type AppStat = {\n  scheduler: string;\n  total_live:number;\n  total:number;\n}\n\nexport type SearchParams = {\n  scheduleId?: string;\n  epochFrom?: number;\n  epochTo?: number;\n  sort?: SortType;\n  sortOrder?: SortOrder;\n  schedulerName: string;\n  max: number; // -1  for all\n};\n\nexport const makeSearchArgs = (p: SearchParams): string => {\n  let res = '?';//`?scheduler-name=${p.schedulerName}`;\n  if (p.scheduleId) {\n    res += `&schedule-id=${p.scheduleId}`;\n  }\n /* if (p.max) {\n    res += `&max=${p.max}`;\n  }*/\n  if (p.sort) {\n    res += `&sort-by=${p.sort} ${p.sortOrder || \"asc\"}`;\n  }\n  if (p.epochFrom) {\n    res += `&epoch-from=${p.epochFrom}`;\n  }\n  if (p.epochTo) {\n    res += `&epoch-to=${p.epochTo}`;\n  }\n  return res;\n};\n\nexport const getAppStats = async (): Promise<AppStat[]> => {\n  return await get(getAppStatsUrl());\n};\n\nexport const listAllSchedulers = async (): Promise<Scheduler[]> => {\n  return await get(getSchedulersUrl());\n};\nexport const makeScheduleInfoModel = (schedules: any[]): ScheduleInfo[] => {\n  if (schedules) {\n    return schedules.map((o) => {\n      return {\n        id: o.schedule.id,\n        scheduler: o.scheduler,\n        timestamp: o.schedule.timestamp,\n        epoch: o.schedule.epoch,\n        targetTopic: o.schedule[\"target-topic\"],\n        targetId: o.schedule[\"target-key\"],\n        value: o.schedule.value,\n      };\n    });\n  }\n  return schedules;\n};\n\nexport const makeScheduleModel = ({ schedule }: any, schedulerName: string): Schedule => {\n  return {\n    id: schedule.id,\n    scheduler: schedulerName,\n    timestamp: schedule.timestamp,\n    epoch: schedule.epoch,\n    targetTopic: schedule[\"target-topic\"],\n    targetId: schedule[\"target-key\"],\n    value: schedule.value,\n    topic: schedule.topic,\n  };\n};\nexport const searchLiveSchedules = async (p: SearchParams): Promise<{found: number; schedules:ScheduleInfo[]}> => {\n  const result: { found: number; schedules: any[] } = await get(\n    getLiveSchedulesUrl(p.schedulerName) + makeSearchArgs(p)\n  );\n\n  const res = {found: result.found, schedules:makeScheduleInfoModel(result.schedules)};\n  return res;\n};\nexport const searchSchedules = async (p: SearchParams): Promise<{found: number; schedules:ScheduleInfo[]}> => {\n  const result: { found: number; schedules: any[] } = await get(getSchedulesUrl(p.schedulerName) + makeSearchArgs(p));\n  return {found: result.found, schedules:makeScheduleInfoModel(result.schedules)};\n};\nexport const getScheduleDetail = async (schedulerName: string, id: string): Promise<Schedule[]> => {\n  const result: Schedule[] = await get(getScheduleDetailUrl(schedulerName, id));\n\n  if (result.length > 0) {\n    return result.map((sch) => makeScheduleModel(sch, schedulerName));\n  }\n  throw new Error(\"Not found\");\n};\n\nexport const getLiveScheduleDetail = async (schedulerName: string, id: string): Promise<Schedule[]> => {\n  const result: Schedule[] = await get(getLiveScheduleDetailUrl(schedulerName, id));\n\n  if (result.length > 0) {\n    return result.map((sch) => makeScheduleModel(sch, schedulerName));\n  }\n  throw new Error(\"Not found\");\n};\n"],"sourceRoot":""}