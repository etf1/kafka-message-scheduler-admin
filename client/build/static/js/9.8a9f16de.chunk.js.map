{"version":3,"sources":["business/page/ScheduleDetail.tsx","business/scheduler/service/SchedulerService.ts","_common/component/layout/container/Container.tsx","_common/component/layout/container/Container.module.css","_common/component/element/icon-label/IconLabel.tsx","business/scheduler/component/ScheduleForm.tsx"],"names":["ScheduleDetail","t","useTranslation","history","useHistory","useParams","schedulerName","scheduleId","size","title","id","onClose","goBack","makeSearchArgs","p","res","max","sort","sortOrder","epochFrom","epochTo","listAllSchedulers","a","get","getSchedulersUrl","makeScheduleInfoModel","schedules","map","o","schedule","scheduler","timestamp","epoch","targetTopic","targetId","value","makeScheduleModel","topic","searchLiveSchedules","getLiveSchedulesUrl","result","console","log","searchSchedules","getSchedulesUrl","getScheduleDetail","getScheduleDetailUrl","length","Error","getLiveScheduleDetail","getLiveScheduleDetailUrl","Container","children","offset","className","clsx","Styles","Column","module","exports","IconLabel","props","items","hasOwnProperty","data","index","icon","label","Fragment","formatUnixTime","time","fmt","dt","fromUnixTime","format","getScheduleValue","atob","err","error","ScheduleForm","live","useState","setSchedule","useEffect","then","style","padding","disabled","textAlign","type","defaultValue","rows","justifyContent","marginTop","onClick"],"mappings":"kGAAA,4DA+BeA,UAvBQ,WAAO,IACpBC,EAAMC,cAAND,EACFE,EAAUC,cAFW,EAOWC,cAA9BC,EAPmB,EAOnBA,cAAeC,EAPI,EAOJA,WAEvB,OACE,cAAC,IAAD,CACEC,KAAM,EACNC,MAAOR,EAAE,6BAA8B,CAAES,GAAIH,IAF/C,SAIE,cAAC,IAAD,CACED,cAAeA,EACfC,WAAYA,EACZI,QAdc,WAClBR,EAAQS,gB,0PCWCC,EAAiB,SAACC,GAC7B,IAAIC,EAAG,0BAAsBD,EAAER,eAgB/B,OAfIQ,EAAEP,aACJQ,GAAG,uBAAoBD,EAAEP,aAEvBO,EAAEE,MACJD,GAAG,eAAYD,EAAEE,MAEfF,EAAEG,OACJF,GAAG,mBAAgBD,EAAEG,KAAlB,YAA0BH,EAAEI,WAAa,QAE1CJ,EAAEK,YACJJ,GAAG,sBAAmBD,EAAEK,YAEtBL,EAAEM,UACJL,GAAG,oBAAiBD,EAAEM,UAEjBL,GAGIM,EAAiB,uCAAG,sBAAAC,EAAA,sEAClBC,YAAIC,eADc,mFAAH,qDAGjBC,EAAwB,SAACC,GACpC,OAAIA,EACKA,EAAUC,KAAI,SAACC,GACpB,MAAO,CACLlB,GAAIkB,EAAEC,SAASnB,GACfoB,UAAWF,EAAEE,UACbC,UAAWH,EAAEC,SAASE,UACtBC,MAAOJ,EAAEC,SAASG,MAClBC,YAAaL,EAAEC,SAAS,gBACxBK,SAAUN,EAAEC,SAAS,cACrBM,MAAOP,EAAEC,SAASM,UAIjBT,GAGIU,EAAoB,SAAC,EAAiB9B,GAAqC,IAArDuB,EAAoD,EAApDA,SACjC,MAAO,CACLnB,GAAImB,EAASnB,GACboB,UAAWxB,EACXyB,UAAWF,EAASE,UACpBC,MAAOH,EAASG,MAChBC,YAAaJ,EAAS,gBACtBK,SAAUL,EAAS,cACnBM,MAAON,EAASM,MAChBE,MAAOR,EAASQ,QAGPC,EAAmB,uCAAG,WAAOxB,GAAP,iBAAAQ,EAAA,sEACyBC,YAAIgB,YAAoBzB,EAAER,eAAiBO,EAAeC,IADnF,cAC3B0B,EAD2B,OAG3BzB,EAAMU,EAAsBe,EAAOd,WACzCe,QAAQC,IAAI3B,GAJqB,kBAK1BA,GAL0B,2CAAH,sDAOnB4B,EAAe,uCAAG,WAAO7B,GAAP,eAAAQ,EAAA,sEAC6BC,YAAIqB,YAAgB9B,EAAER,eAAiBO,EAAeC,IADnF,cACvB0B,EADuB,yBAEtBf,EAAsBe,EAAOd,YAFP,2CAAH,sDAIfmB,EAAiB,uCAAG,WAAOvC,EAAuBI,GAA9B,eAAAY,EAAA,sEACEC,YAAIuB,YAAqBxC,EAAeI,IAD1C,aACzB8B,EADyB,QAGpBO,OAAS,GAHW,yCAItBX,EAAkBI,EAAO,GAAIlC,IAJP,aAMzB,IAAI0C,MAAM,aANe,2CAAH,wDASjBC,EAAqB,uCAAG,WAAO3C,EAAuBI,GAA9B,eAAAY,EAAA,sEACFC,YAAI2B,YAAyB5C,EAAeI,IAD1C,aAC7B8B,EAD6B,QAGxBO,OAAS,GAHe,yCAI1BX,EAAkBI,EAAO,GAAIlC,IAJH,aAM7B,IAAI0C,MAAM,aANmB,2CAAH,yD,iCC/FlC,qCAmCeG,IA5B6B,SAAC,GAItC,IAHL1C,EAGI,EAHJA,MAGI,IAFJD,YAEI,MAFG,GAEH,EADJ4C,EACI,EADJA,SAEIC,EAAS,GAMb,OALa,IAAT7C,EACF6C,EAAS,cACS,KAAT7C,IACT6C,EAAS,eAGT,qBAAKC,UAAU,YAAf,SACE,sBACEA,UAAWC,YACT,SACA/C,EAAO,MAAQA,EAAO,KACtB6C,EACAG,IAAOC,QALX,UAQE,oBAAIH,UAAU,aAAd,SAA4B7C,IAC3B2C,S,oBC5BTM,EAAOC,QAAU,CAAC,OAAS,4B,2HCgB3B,IAkBeC,EAlB6B,SAACC,GAC3C,IAAIC,EAA0CD,EAJjCE,eAAe,QAI2BF,EAAMG,KAAO,CAACH,GACrE,OACE,sBAAMP,UAAU,YAAhB,SACGQ,EAAMnC,KAAI,WAAiCsC,GAAmB,IAAjDC,EAAgD,EAAhDA,KAAMC,EAA0C,EAA1CA,MAClB,OACE,eAAC,IAAMC,SAAP,WACE,sBAAMd,UAAU,OAAhB,SACE,mBAAGA,UAAS,iBAAYY,OAE1B,+BAAOC,MAJYF,SCdzBI,EAAiB,SAACC,EAAcC,GACpC,GAAID,EAAM,CACR,IAAME,EAAKC,IAAaH,GACxB,OAAOI,IAAOF,EAAID,GAEpB,MAAO,IAGHI,EAAmB,SAACxC,GACxB,IACE,OAAOyC,KAAKzC,GACZ,MAAM0C,GACNpC,QAAQqC,MAAMD,GAEhB,OAAO1C,GAwGM4C,IA9FmC,SAAC,GAAkD,IAAhDzE,EAA+C,EAA/CA,cAAeC,EAAgC,EAAhCA,WAAYI,EAAoB,EAApBA,QAASqE,EAAW,EAAXA,KAC/E/E,EAAMC,cAAND,EAD0F,EAElEgF,qBAFkE,mBAE3FpD,EAF2F,KAEjFqD,EAFiF,KAalG,OAVAC,qBAAU,WACJ7E,GAAiBC,IACnByE,EAAO/B,YAAsB3C,EAAeC,GAAY6E,MAAK,SAAC5C,GAC5D0C,EAAY1C,MACVK,YAAkBvC,EAAeC,GAAY6E,MAAK,SAAC5C,GACrD0C,EAAY1C,SAGf,CAAClC,EAAeC,EAAYyE,IAG7B,sBAAK1B,UAAU,MAAM+B,MAAO,CAAEC,QAAS,QAAvC,UACGzD,GACC,sBAAKyB,UAAU,UAAf,UACE,qBAAKA,UAAU,SAAf,SACE,2BAAUiC,UAAQ,EAACF,MAAO,CAAEG,UAAW,QAAvC,UACE,sBAAKlC,UAAU,QAAf,UACE,uBAAOA,UAAU,QAAjB,SAA0BrD,EAAE,uBAC5B,qBAAKqD,UAAU,UAAf,SACE,uBAAOA,UAAU,QAAQmC,KAAK,OAAOC,aAAc7D,EAASnB,UAGhE,sBAAK4C,UAAU,QAAf,UACE,uBAAOA,UAAU,QAAjB,SAA0BrD,EAAE,8BAC5B,qBAAKqD,UAAU,UAAf,SACE,uBAAOA,UAAU,QAAQmC,KAAK,OAAOC,aAAc7D,EAASC,iBAGhE,sBAAKwB,UAAU,QAAf,UACE,uBAAOA,UAAU,QAAjB,SAA0BrD,EAAE,kCAC5B,qBAAKqD,UAAU,UAAf,SACE,uBACEA,UAAU,QACVmC,KAAK,MACLC,aAAcrB,EAAexC,EAASE,UAAW9B,EAAE,qCAIzD,sBAAKqD,UAAU,QAAf,UACE,uBAAOA,UAAU,QAAjB,SAA0BrD,EAAE,iCAC5B,qBAAKqD,UAAU,UAAf,SACE,uBACEA,UAAU,QACVmC,KAAK,MACLC,aAAcrB,EAAexC,EAASG,MAAO/B,EAAE,qCAIrD,sBAAKqD,UAAU,QAAf,UACE,uBAAOA,UAAU,QAAjB,SAA0BrD,EAAE,iCAC5B,qBAAKqD,UAAU,UAAf,SACE,uBAAOA,UAAU,QAAQmC,KAAK,OAAOC,aAAc7D,EAASQ,aAGhE,sBAAKiB,UAAU,QAAf,UACE,uBAAOA,UAAU,QAAjB,SAA0BrD,EAAE,iCAC5B,qBAAKqD,UAAU,UAAf,SACE,uBAAOA,UAAU,QAAQmC,KAAK,OAAOC,aAAc7D,EAASI,mBAGhE,sBAAKqB,UAAU,QAAf,UACE,uBAAOA,UAAU,QAAjB,SAA0BrD,EAAE,8BAC5B,qBAAKqD,UAAU,UAAf,SACE,uBAAOA,UAAU,QAAQmC,KAAK,OAAOC,aAAc7D,EAASK,qBAKpE,qBAAKoB,UAAU,SAAf,SACA,0BAAUiC,UAAQ,EAACF,MAAO,CAAEG,UAAW,QAAvC,SACE,sBAAKlC,UAAU,QAAf,UACE,uBAAOA,UAAU,QAAjB,SAA0BrD,EAAE,0BAC5B,qBAAKqD,UAAU,UAAf,SACE,0BAAUqC,KAAM,GAAIrC,UAAU,WAAWoC,aAAcf,EAAiB9C,EAASM,qBAO3F,qBAAKmB,UAAU,oBAAoB+B,MAAO,CAAEO,eAAgB,SAAUC,UAAW,QAAjF,SACE,qBAAKvC,UAAU,UAAf,SACE,wBAAQA,UAAU,iBAAiBwC,QAASnF,EAA5C,SACE,cAAC,EAAD,CAAWuD,KAAK,QAAQC,MAAOlE,EAAE","file":"static/js/9.8a9f16de.chunk.js","sourcesContent":["import ScheduleForm from \"business/scheduler/component/ScheduleForm\";\nimport React from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport Container from \"_common/component/layout/container/Container\";\n\ntype ScheduleDetailUrlParams = { schedulerName: string; scheduleId: string };\n\nconst ScheduleDetail = () => {\n  const { t } = useTranslation();\n  const history = useHistory();\n  const handleClose = () => {\n    history.goBack();\n  };\n\n  const { schedulerName, scheduleId } = useParams<ScheduleDetailUrlParams>();\n\n  return (\n    <Container\n      size={8}\n      title={t(\"Page-title-schedule-detail\", { id: scheduleId })}\n    >\n      <ScheduleForm\n        schedulerName={schedulerName}\n        scheduleId={scheduleId}\n        onClose={handleClose}\n      />\n    </Container>\n  );\n};\n\nexport default ScheduleDetail;\n","import { get } from \"_common/service/ApiUtil\";\nimport {\n  getLiveScheduleDetailUrl,\n  getLiveSchedulesUrl,\n  getScheduleDetailUrl,\n  getSchedulersUrl,\n  getSchedulesUrl,\n} from \"_core/service/config\";\nimport { Schedule, ScheduleInfo, Scheduler } from \"../type\";\n\nexport type SortType = \"id\" | \"epoch\" | \"timestamp\";\nexport type SortOrder = \"asc\" | \"desc\";\n\nexport type SearchParams = {\n  scheduleId?: string;\n  epochFrom?: number;\n  epochTo?: number;\n  sort?: SortType;\n  sortOrder?: SortOrder;\n  schedulerName: string;\n  max: number; // -1  for all\n};\n\nexport const makeSearchArgs = (p: SearchParams): string => {\n  let res = `?scheduler-name=${p.schedulerName}`;\n  if (p.scheduleId) {\n    res += `&schedule-id=${p.scheduleId}`;\n  }\n  if (p.max) {\n    res += `&max=${p.max}`;\n  }\n  if (p.sort) {\n    res += `&sort-by=${p.sort} ${p.sortOrder || \"asc\"}`;\n  }\n  if (p.epochFrom) {\n    res += `&epoch-from=${p.epochFrom}`;\n  }\n  if (p.epochTo) {\n    res += `&epoch-to=${p.epochTo}`;\n  }\n  return res;\n};\n\nexport const listAllSchedulers = async (): Promise<Scheduler[]> => {\n  return await get(getSchedulersUrl());\n};\nexport const makeScheduleInfoModel = (schedules: any[]): ScheduleInfo[] => {\n  if (schedules) {\n    return schedules.map((o) => {\n      return {\n        id: o.schedule.id,\n        scheduler: o.scheduler,\n        timestamp: o.schedule.timestamp,\n        epoch: o.schedule.epoch,\n        targetTopic: o.schedule[\"target-topic\"],\n        targetId: o.schedule[\"target-key\"],\n        value: o.schedule.value,\n      };\n    });\n  }\n  return schedules;\n};\n\nexport const makeScheduleModel = ({schedule}: any, schedulerName: string): Schedule => {\n  return {\n    id: schedule.id,\n    scheduler: schedulerName,\n    timestamp: schedule.timestamp,\n    epoch: schedule.epoch,\n    targetTopic: schedule[\"target-topic\"],\n    targetId: schedule[\"target-key\"],\n    value: schedule.value,\n    topic: schedule.topic,\n  };\n};\nexport const searchLiveSchedules = async (p: SearchParams): Promise<ScheduleInfo[]> => {\n  const result: { found: number; schedules: any[] } = await get(getLiveSchedulesUrl(p.schedulerName) + makeSearchArgs(p));\n\n  const res = makeScheduleInfoModel(result.schedules);\n  console.log(res);\n  return res;\n};\nexport const searchSchedules = async (p: SearchParams): Promise<ScheduleInfo[]> => {\n  const result: { found: number; schedules: any[] } = await get(getSchedulesUrl(p.schedulerName) + makeSearchArgs(p));\n  return makeScheduleInfoModel(result.schedules);\n};\nexport const getScheduleDetail = async (schedulerName: string, id: string): Promise<Schedule> => {\n  const result: Schedule[] = await get(getScheduleDetailUrl(schedulerName, id));\n\n  if (result.length > 0) {\n    return makeScheduleModel(result[0], schedulerName);\n  }\n  throw new Error(\"Not found\");\n};\n\nexport const getLiveScheduleDetail = async (schedulerName: string, id: string): Promise<Schedule> => {\n  const result: Schedule[] = await get(getLiveScheduleDetailUrl(schedulerName, id));\n\n  if (result.length > 0) {\n    return makeScheduleModel(result[0], schedulerName);\n  }\n  throw new Error(\"Not found\");\n};\n","import clsx from \"clsx\";\nimport Styles from \"./Container.module.css\";\n\nexport type ContainerProps = {\n  title: string;\n  size?: 12 | 10 | 8;\n};\nconst Container: React.FC<ContainerProps> = ({\n  title,\n  size = 12,\n  children,\n}) => {\n  let offset = \"\";\n  if (size === 8) {\n    offset = \"is-offset-2\";\n  } else if (size === 10) {\n    offset = \"is-offset-1\";\n  }\n  return (\n    <div className=\"container\">\n      <div\n        className={clsx(\n          \"column\",\n          size ? \"is-\" + size : null,\n          offset,\n          Styles.Column\n        )}\n      >\n        <h3 className=\"title is-5\">{title}</h3>\n        {children}\n      </div>\n    </div>\n  );\n};\n\nexport default Container;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Column\":\"Container_Column__3FknH\"};","import React from \"react\";\n\nexport type IconLabelItem = {\n  icon: string;\n  label: React.ReactNode;\n};\nexport type IconLabelItems = {\n  data: IconLabelItem[];\n};\n\nexport type IconLabelProps = IconLabelItems | IconLabelItem;\nexport function isIconLabelItems(\n  value: IconLabelItems | IconLabelItem\n): value is IconLabelItems {\n  return value.hasOwnProperty(\"data\");\n}\n\nconst IconLabel: React.FC<IconLabelProps> = (props) => {\n  let items: IconLabelItem[] = isIconLabelItems(props) ? props.data : [props];\n  return (\n    <span className=\"icon-text\">\n      {items.map(({ icon, label }: IconLabelItem, index: number) => {\n        return (\n          <React.Fragment key={index}>\n            <span className=\"icon\">\n              <i className={`fas fa-${icon}`}></i>\n            </span>\n            <span>{label}</span>\n          </React.Fragment>\n        );\n      })}\n    </span>\n  );\n};\n\nexport default IconLabel;\n","import { useTranslation } from \"react-i18next\";\nimport fromUnixTime from \"date-fns/fromUnixTime\";\nimport format from \"date-fns/format\";\n\nimport { useEffect, useState } from \"react\";\nimport { Schedule } from \"../type\";\nimport { getLiveScheduleDetail, getScheduleDetail } from \"../service/SchedulerService\";\nimport IconLabel from \"_common/component/element/icon-label/IconLabel\";\n\nconst formatUnixTime = (time: number, fmt: string) => {\n  if (time) {\n    const dt = fromUnixTime(time);\n    return format(dt, fmt);\n  }\n  return \"\";\n};\n\nconst getScheduleValue = (value:string) => {\n  try {\n    return atob(value);\n  } catch(err) {\n    console.error(err);\n  }\n  return value;\n}\n\nexport type ScheduleFormProps = {\n  schedulerName: string;\n  scheduleId: string;\n  onClose: () => void;\n  live?:boolean;\n};\n\nconst ScheduleForm: React.FC<ScheduleFormProps> = ({ schedulerName, scheduleId, onClose, live }) => {\n  const { t } = useTranslation();\n  const [schedule, setSchedule] = useState<Schedule>();\n  useEffect(() => {\n    if (schedulerName && scheduleId) {\n      live ? getLiveScheduleDetail(schedulerName, scheduleId).then((result) => {\n        setSchedule(result);\n      }): getScheduleDetail(schedulerName, scheduleId).then((result) => {\n        setSchedule(result);\n      });\n    }\n  }, [schedulerName, scheduleId, live]);\n\n  return (\n    <div className=\"box\" style={{ padding: \"3rem\" }}>\n      {schedule && (\n        <div className=\"columns\">\n          <div className=\"column\">\n            <fieldset disabled style={{ textAlign: \"left\" }}>\n              <div className=\"field\">\n                <label className=\"label\">{t(\"Schedule-field-id\")}</label>\n                <div className=\"control\">\n                  <input className=\"input\" type=\"text\" defaultValue={schedule.id} />\n                </div>\n              </div>\n              <div className=\"field\">\n                <label className=\"label\">{t(\"Schedule-field-scheduler\")}</label>\n                <div className=\"control\">\n                  <input className=\"input\" type=\"text\" defaultValue={schedule.scheduler} />\n                </div>\n              </div>\n              <div className=\"field\">\n                <label className=\"label\">{t(\"Schedule-field-creation-date\")}</label>\n                <div className=\"control\">\n                  <input\n                    className=\"input\"\n                    type=\"tex\"\n                    defaultValue={formatUnixTime(schedule.timestamp, t(\"Calendar-date-hour-format\"))}\n                  />\n                </div>\n              </div>\n              <div className=\"field\">\n                <label className=\"label\">{t(\"Schedule-field-trigger-date\")}</label>\n                <div className=\"control\">\n                  <input\n                    className=\"input\"\n                    type=\"tex\"\n                    defaultValue={formatUnixTime(schedule.epoch, t(\"Calendar-date-hour-format\"))}\n                  />\n                </div>\n              </div>\n              <div className=\"field\">\n                <label className=\"label\">{t(\"Schedule-field-source-topic\")}</label>\n                <div className=\"control\">\n                  <input className=\"input\" type=\"text\" defaultValue={schedule.topic} />\n                </div>\n              </div>\n              <div className=\"field\">\n                <label className=\"label\">{t(\"Schedule-field-target-topic\")}</label>\n                <div className=\"control\">\n                  <input className=\"input\" type=\"text\" defaultValue={schedule.targetTopic} />\n                </div>\n              </div>\n              <div className=\"field\">\n                <label className=\"label\">{t(\"Schedule-field-target-id\")}</label>\n                <div className=\"control\">\n                  <input className=\"input\" type=\"text\" defaultValue={schedule.targetId} />\n                </div>\n              </div>\n            </fieldset>\n          </div>\n          <div className=\"column\">\n          <fieldset disabled style={{ textAlign: \"left\" }}>\n            <div className=\"field\">\n              <label className=\"label\">{t(\"Schedule-field-value\")}</label>\n              <div className=\"control\">\n                <textarea rows={12} className=\"textarea\" defaultValue={getScheduleValue(schedule.value)} />\n              </div>\n            </div>\n            </fieldset>\n          </div>\n        </div>\n      )}\n      <div className=\"field is-grouped \" style={{ justifyContent: \"center\", marginTop: \"2rem\" }}>\n        <div className=\"control\">\n          <button className=\"button is-link\" onClick={onClose}>\n            <IconLabel icon=\"times\" label={t(\"Close-button\")} />\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ScheduleForm;\n"],"sourceRoot":""}