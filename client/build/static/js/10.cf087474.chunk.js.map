{"version":3,"sources":["business/scheduler/component/SchedulerTable.tsx","business/scheduler/page/Schedulers.tsx","_common/component/transition/Appear.tsx","business/scheduler/service/SchedulerService.ts","_common/component/layout/panel/Panel.tsx","_common/component/transition/Appear.module.css","_common/component/layout/panel/Panel.module.css","business/scheduler/hook/useSchedulers.ts","business/scheduler/component/SchedulerTable.module.css"],"names":["SchedulerTable","schedulers","detailUrl","onClick","t","useTranslation","className","style","cursor","map","scheduler","clsx","Style","ColWithId","ColWithLink","to","resolvePath","schedulerName","name","http_port","instances","length","Schedulers","useSchedulers","error","Panel","icon","title","fontWeight","color","Icon","ROUTE_SCHEDULER_DETAIL","Appear","visible","timeout","fadeMore","children","nodeRef","React","useRef","in","classNames","enter","enterActive","enterMoreActive","exit","exitActive","exitMoreActive","makeSearchArgs","p","res","scheduleId","sort","sortOrder","epochFrom","epochTo","getAppStats","a","get","getAppStatsUrl","listAllSchedulers","getSchedulersUrl","makeScheduleInfoModel","schedules","o","id","schedule","timestamp","epoch","targetTopic","targetId","value","makeScheduleModel","topic","searchLiveSchedules","getLiveSchedulesUrl","result","found","searchSchedules","getSchedulesUrl","getScheduleDetail","getScheduleDetailUrl","sch","Error","getLiveScheduleDetail","getLiveScheduleDetailUrl","iconStyle","rightHeader","allowCollapse","restProps","useState","isDown","setIsDown","handleClick","Title","TitleIcon","size","ref","CollapseIcon","Children","count","module","exports","useRefresh","refresh","setSchedulers","isLoading","setIsLoading","setError","useEffect","undefined","console"],"mappings":"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","file":"static/js/10.cf087474.chunk.js","sourcesContent":["import clsx from \"clsx\";\nimport { useTranslation } from \"react-i18next\";\nimport { Link } from \"react-router-dom\";\nimport { resolvePath } from \"_core/router/routes\";\nimport { Scheduler } from \"../type\";\nimport Style from \"./SchedulerTable.module.css\";\n\nexport type SchedulerTableProps = {\n    schedulers : Scheduler[];\n    onClick?: (scheduler:Scheduler) => void;\n    detailUrl: string;\n}\n\nconst SchedulerTable:React.FC<SchedulerTableProps> = ({schedulers, detailUrl, onClick})=>{\n    const { t } = useTranslation();\n    return (\n        <table key=\"table\" className=\"table is-striped is-hoverable is-fullwidth\">\n        <thead>\n          <tr>\n            <th style={{cursor:\"pointer\"}}>{t(\"SchedulerTable-column-Name\")}</th>\n            <th style={{cursor:\"pointer\"}}>{t(\"SchedulerTable-column-Port\")}</th>\n            <th style={{cursor:\"pointer\"}}>{t(\"SchedulerTable-column-Nb-Instances\")}</th>\n     \n          </tr>\n        </thead>\n  \n        <tbody>\n          {schedulers.map((scheduler) => {\n            return (\n              <tr key={`${scheduler.name}`} onClick={() => onClick && onClick(scheduler)}>\n                <td className={clsx(Style.ColWithId, Style.ColWithLink)}>\n                  <Link\n                    to={resolvePath(detailUrl, {\n                      schedulerName: scheduler.name\n                    })}\n                  >\n                    {scheduler.name}\n                  </Link>\n                </td>\n                <td> \n                {scheduler.http_port}\n                </td>\n                <td> \n                {scheduler.instances.length}\n                </td>\n              </tr>\n            );\n          })}\n        </tbody>\n      </table>\n    )\n}\n\n\nexport default SchedulerTable;","import SchedulerTable from \"business/scheduler/component/SchedulerTable\";\nimport useSchedulers from \"business/scheduler/hook/useSchedulers\";\nimport React from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport Icon from \"_common/component/element/icon/Icon\";\nimport Panel from \"_common/component/layout/panel/Panel\";\nimport { ROUTE_SCHEDULER_DETAIL } from \"_core/router/routes\";\n\nconst Schedulers = () => {\n  const { t } = useTranslation();\n  const { schedulers, error } = useSchedulers();\n\n  return (\n    <Panel icon={\"stopwatch\"} title={t(\"Page-title-schedulers\")}>\n      {error && <div className=\"animate-opacity\" style={{ fontWeight: 800, color: \"red\" }}><Icon name=\"exclamation-triangle\"/> {t(\"LoadingError\")}</div>}\n      {!error && schedulers && <SchedulerTable schedulers={schedulers} detailUrl={ROUTE_SCHEDULER_DETAIL} />}\n    </Panel>\n  );\n};\n\nexport default Schedulers;\n","import React from \"react\";\nimport { CSSTransition } from \"react-transition-group\";\nimport Style from \"./Appear.module.css\";\n\nexport type AppearProps = {\n  visible: boolean | undefined;\n  timeout?: number;\n  fadeMore?: boolean;\n  children?: (nodeRef: React.MutableRefObject<null>) => React.ReactNode;\n};\nconst Appear = ({ visible, timeout, fadeMore, children }: AppearProps) => {\n  const nodeRef = React.useRef(null);\n  return (\n    <CSSTransition\n      in={visible}\n      timeout={timeout || 2000}\n      nodeRef={nodeRef}\n      classNames={{\n        enter: Style.enter,\n        enterActive: fadeMore ? Style.enterMoreActive : Style.enterActive,\n        exit: Style.exit,\n        exitActive: fadeMore ? Style.exitMoreActive : Style.exitActive\n      }}\n    >\n      {children && children(nodeRef)}\n    </CSSTransition>\n  );\n};\n\nexport default Appear;\n","import { get } from \"_common/service/ApiUtil\";\nimport {\n  getAppStatsUrl,\n  getLiveScheduleDetailUrl,\n  getLiveSchedulesUrl,\n  getScheduleDetailUrl,\n  getSchedulersUrl,\n  getSchedulesUrl,\n} from \"_core/service/config\";\nimport { Schedule, ScheduleInfo, Scheduler } from \"../type\";\n\nexport type SortType = \"id\" | \"epoch\" | \"timestamp\";\nexport type SortOrder = \"asc\" | \"desc\";\nexport type AppStat = {\n  scheduler: string;\n  total_live:number;\n  total:number;\n}\n\nexport type SearchParams = {\n  scheduleId?: string;\n  epochFrom?: number;\n  epochTo?: number;\n  sort?: SortType;\n  sortOrder?: SortOrder;\n  schedulerName: string;\n  max: number; // -1  for all\n};\n\nexport const makeSearchArgs = (p: SearchParams): string => {\n  let res = '?';//`?scheduler-name=${p.schedulerName}`;\n  if (p.scheduleId) {\n    res += `&schedule-id=${p.scheduleId}`;\n  }\n /* if (p.max) {\n    res += `&max=${p.max}`;\n  }*/\n  if (p.sort) {\n    res += `&sort-by=${p.sort} ${p.sortOrder || \"asc\"}`;\n  }\n  if (p.epochFrom) {\n    res += `&epoch-from=${p.epochFrom}`;\n  }\n  if (p.epochTo) {\n    res += `&epoch-to=${p.epochTo}`;\n  }\n  return res;\n};\n\nexport const getAppStats = async (): Promise<AppStat[]> => {\n  return await get(getAppStatsUrl());\n};\n\nexport const listAllSchedulers = async (): Promise<Scheduler[]> => {\n  return await get(getSchedulersUrl());\n};\nexport const makeScheduleInfoModel = (schedules: any[]): ScheduleInfo[] => {\n  if (schedules) {\n    return schedules.map((o) => {\n      return {\n        id: o.schedule.id,\n        scheduler: o.scheduler,\n        timestamp: o.schedule.timestamp,\n        epoch: o.schedule.epoch,\n        targetTopic: o.schedule[\"target-topic\"],\n        targetId: o.schedule[\"target-key\"],\n        value: o.schedule.value,\n      };\n    });\n  }\n  return schedules;\n};\n\nexport const makeScheduleModel = ({ schedule }: any, schedulerName: string): Schedule => {\n  return {\n    id: schedule.id,\n    scheduler: schedulerName,\n    timestamp: schedule.timestamp,\n    epoch: schedule.epoch,\n    targetTopic: schedule[\"target-topic\"],\n    targetId: schedule[\"target-key\"],\n    value: schedule.value,\n    topic: schedule.topic,\n  };\n};\nexport const searchLiveSchedules = async (p: SearchParams): Promise<{found: number; schedules:ScheduleInfo[]}> => {\n  const result: { found: number; schedules: any[] } = await get(\n    getLiveSchedulesUrl(p.schedulerName) + makeSearchArgs(p)\n  );\n\n  const res = {found: result.found, schedules:makeScheduleInfoModel(result.schedules)};\n  return res;\n};\nexport const searchSchedules = async (p: SearchParams): Promise<{found: number; schedules:ScheduleInfo[]}> => {\n  const result: { found: number; schedules: any[] } = await get(getSchedulesUrl(p.schedulerName) + makeSearchArgs(p));\n  return {found: result.found, schedules:makeScheduleInfoModel(result.schedules)};\n};\nexport const getScheduleDetail = async (schedulerName: string, id: string): Promise<Schedule[]> => {\n  const result: Schedule[] = await get(getScheduleDetailUrl(schedulerName, id));\n\n  if (result.length > 0) {\n    return result.map((sch) => makeScheduleModel(sch, schedulerName));\n  }\n  throw new Error(\"Not found\");\n};\n\nexport const getLiveScheduleDetail = async (schedulerName: string, id: string): Promise<Schedule[]> => {\n  \n  const result: Schedule[] = await get(getLiveScheduleDetailUrl(schedulerName, id));\n\n  if (result.length > 0) {\n    return result.map((sch) => makeScheduleModel(sch, schedulerName));\n  }\n  throw new Error(\"Not found\");\n};\n","import clsx from \"clsx\";\nimport React, { useState } from \"react\";\nimport Appear from \"_common/component/transition/Appear\";\nimport Icon from \"_common/component/element/icon/Icon\";\nimport Style from \"./Panel.module.css\";\n\ntype PanelProps = {\n  title?: React.ReactNode;\n  icon?: string;\n  iconStyle?: React.CSSProperties;\n  rightHeader?: React.ReactNode;\n  allowCollapse?: boolean;\n  className?: string;\n};\n\nconst Panel: React.FC<PanelProps> = ({\n  title,\n  icon,\n  iconStyle,\n  rightHeader,\n  className,\n  allowCollapse = false,\n  children,\n  ...restProps\n}) => {\n  const [isDown, setIsDown] = useState<boolean>(true);\n  const handleClick = () => {\n    allowCollapse && setIsDown((isDown) => !isDown);\n  };\n\n  return (\n    <div className={clsx(\"box\", Style.Panel, className)} {...restProps}>\n      <div className=\"columns\">\n        <div className=\"column\" onClick={handleClick}>\n          <p className={clsx(\"title is-4\", Style.Title)}>\n            {icon && (\n              <Icon\n                name={icon}\n                className={Style.TitleIcon}\n                size=\"lg\"\n                style={iconStyle}\n              />\n            )}\n            <Appear visible={!!title}>\n              {(nodeRef) => (\n                <span ref={nodeRef} className=\"ml5\">\n                  {title}\n                </span>\n              )}\n            </Appear>\n          </p>\n        </div>\n        {rightHeader && <div className=\"column is-narrow\">{rightHeader}</div>}\n        {allowCollapse && (\n          <div\n            className={clsx(\"column is-narrow\", Style.CollapseIcon)}\n            onClick={handleClick}\n          >\n            <Icon name={isDown ? \"chevron-up\" : \"chevron-down\"} />\n          </div>\n        )}\n      </div>\n      <Appear visible={!!(isDown && React.Children.count(children) > 0)}>\n        {(nodeRef) => <div ref={nodeRef}>{children}</div>}\n      </Appear>\n    </div>\n  );\n};\n\nexport default Panel;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"enter\":\"Appear_enter__3WCKW\",\"enterActive\":\"Appear_enterActive__3_cy6\",\"exit\":\"Appear_exit__1YU6A\",\"exitActive\":\"Appear_exitActive__1vJVi\",\"enterMoreActive\":\"Appear_enterMoreActive__1fVNK\",\"exitMoreActive\":\"Appear_exitMoreActive__OKk_T\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Panel\":\"Panel_Panel__1jxoT\",\"Title\":\"Panel_Title__AcpeW\",\"TitleIcon\":\"Panel_TitleIcon__oIazQ\",\"CollapseIcon\":\"Panel_CollapseIcon__1XtgC\"};","import { useEffect, useState } from \"react\";\nimport useRefresh from \"_common/hook/useRefresh\";\nimport { listAllSchedulers } from \"../service/SchedulerService\";\nimport { Scheduler } from \"./../type/index\";\nconst useSchedulers = () => {\n  const [refresh, count] = useRefresh();\n  const [schedulers, setSchedulers] = useState<Scheduler[]>([]);\n  const [isLoading, setIsLoading] = useState<boolean>(true);\n  const [error, setError] = useState<Error>();\n  useEffect(() => {\n    setIsLoading(true);\n    (async () => {\n      try {\n        const res = await listAllSchedulers();\n        setSchedulers(res);\n        setIsLoading(false);\n        setError(undefined);\n      } catch (err) {\n        console.error(err);\n        setError(err);\n      }\n   \n    })();\n  }, [count]);\n\n  return { schedulers, isLoading, refresh, error };\n};\n\nexport default useSchedulers;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ColWithId\":\"SchedulerTable_ColWithId__3uZWE\",\"ColWithLink\":\"SchedulerTable_ColWithLink__2ihq0\",\"ValueField\":\"SchedulerTable_ValueField__1-hdk\"};"],"sourceRoot":""}